document.currentScript=document.currentScript||function(){var e=document.getElementsByTagName("script");return e[e.length-1]}();const key=document.currentScript.dataset.key,baseUrl=document.currentScript.dataset.url||"https://sushilytics.com";class Sushilytics{names=[];observer=null;constructor(){}start(){this.observer=new IntersectionObserver(e=>{e.forEach(t=>{if(t.isIntersecting){const s=this.names.findIndex(e=>e.name===t.target.getAttribute("data-sushi")&&null===e.eventId);0<=s&&(this.observer.unobserve(t.target),fetch(`${baseUrl}/api/projects/${key}/sushis/${this.names[s].name}/sushi-events`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(e=>e.json()).then(e=>{this.names[s].eventId=e.id}))}})}),this.names=Array.from(document.querySelectorAll("[data-sushi]")).map(e=>{if(void 0!==e.checkVisibility&&!e.checkVisibility())return null;const t=e.getAttribute("data-sushi");return null===t?null:(e.addEventListener("mouseover",()=>{var e=this.names.findIndex(e=>e.name===t&&!e.hovered);0<=e&&(this.names[e].hovered=!0,fetch(baseUrl+"/api/sushi-events/"+this.names[e].eventId,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({event:"hover"})}))}),e.addEventListener("click",()=>{var e=this.names.findIndex(e=>e.name===t&&!e.clicked);0<=e&&(this.names[e].clicked=!0,fetch(baseUrl+"/api/sushi-events/"+this.names[e].eventId,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({event:"click"})}))}),this.observer.observe(e),{name:t,eventId:null,hovered:!1,clicked:!1})}),0<this.names.length&&fetch(`${baseUrl}/api/projects/${key}/sushis`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({names:this.names.filter(e=>null!==e).map(e=>e.name)})})}}window.Sushilytics=new Sushilytics,window.Sushilytics.start();
